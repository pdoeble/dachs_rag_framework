{
  "version": "0.4.0",
  "description": "Config for generate_qa_candidates: deeper exam-style QA + strict grounding + adaptive per-document limits + traceability.",

  "paths": {
    "paths_file": "config/paths/paths.json",
    "prompt_system_file": "config/prompts/qa_generation_system.txt",
    "prompt_user_template_file": "config/prompts/qa_generation_user.txt"
  },

  "filters": {
    "languages_allowed": ["de", "en"],
    "trust_levels_allowed": ["high", "medium"],

    "chunk_roles_allowed": ["definition", "explanation", "example", "key_result", "exercise"],
    "allow_missing_chunk_role": true,

    "content_types_allowed": ["textbook", "handbook", "paper", "simulation_report", "api_doc", "software_manual"],

    "min_content_chars": 150
  },

  "neighbors": {
    "top_k_faiss": 28,
    "similarity_threshold": 0.25,
    "max_neighbors": 10,

    "max_local_neighbors_before": 1,
    "max_local_neighbors_after": 1,

    "prefer_same_doc_if_domain_missing": true,
    "prefer_same_doc_if_content_type_missing": true
  },

  "grouping": {
    "min_group_size": 2,
    "max_group_size": 7,

    "max_chars_per_chunk": 1400,
    "max_total_context_chars": 14000
  },

  "sampling": {
    "max_qa_per_group": 3,
    "max_groups_per_chunk": 1,

    "max_qa_per_document": {
      "mode": "adaptive",
      "min": 10,
      "max": 220,
      "per_100_chunks": 6.0,
      "per_100k_chars": 1.0
    },

    "global_qa_limit": 20000,
    "sampling_strategy": "sequential"
  },

  "llm": {
    "backend": "ollama",
    "model": "qwen2.5:32b-instruct-q4_K_M",
    "temperature": 0.0,
    "top_p": 0.9,
    "max_tokens": 1100,

    "request_timeout_s": 300,
    "max_retries": 3,
    "retry_backoff_s": 5.0
  },

  "runtime": {
    "num_workers": 1,
    "shuffle_files": true,
    "resume_mode": "append",
    "dry_run": false,

    "log_level": "INFO",
    "log_every_n_examples": 50,

    "grounding_enabled": true,
    "grounding_min_coverage_question": 0.55,
    "grounding_min_coverage_answer": 0.45,
    "grounding_drop_if_meta_leak": true
  },

  "output": {
    "qa_schema_version": "v1",
    "include_source_text": false,
    "include_semantic_tags": true,
    "output_file_pattern": "{input_basename}.qa_candidates.jsonl"
  },

  "debug": {
    "limit_num_files": 0,
    "limit_num_chunks": 0,

    "dump_example_prompts": false,
    "example_prompts_dir": "logs/qa_prompts"
  }
}
